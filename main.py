import requests
from bs4 import BeautifulSoup

badChars = ["'", "<", ">", "(", ")", ";"]

def spiderInputs(url: str):
    response = requests.get(url)
    soup = BeautifulSoup(response.text, "html.parser")
    form = soup.find("form")

    if not form:
        print("no form has been found")
        return []
    
    return form.find_all("input")

def testInput(url: str, inputs: list):
    results = {}

    for inputField in inputs:
        name = inputField.get("name")

        if name:
            for badChar in badChars:
                payload = { name: badChar }
                response = requests.post(url, data = payload)
                key = f"{url} input field: {name} payload {badChar}"
                results[key] = response.status_code

    return results

def main():
    url = input("enter url to scan: ")

    inputs = spiderInputs(url)
    if not inputs:
        return
    
    results = testInput(url, inputs)
    for key, value in results.items():
        print(f"{key} and status code {value}")


if __name__ == "__main__":
    main()